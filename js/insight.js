!function(s,a){var e=s(".ins-search"),n=e.find(".ins-search-input"),r=e.find(".ins-section-wrapper"),o=e.find(".ins-section-container");function c(n,t,e,i,r){return s("<div>").addClass("ins-selectable").addClass("ins-search-item").append(s("<header>").append(s("<i>").addClass("fa").addClass("fa-"+n)).append(null!=t&&""!=t?t:a.TRANSLATION.UNTITLED).append(e?s("<span>").addClass("ins-slug").text(e):null)).append(i?s("<p>").addClass("ins-search-preview").text(i):null).attr("data-url",r)}function i(t,n){var e,i,r;if(0===n.length)return null;switch(e=a.TRANSLATION[t],t){case"POSTS":case"PAGES":i=n.map(function(n){return c("file",n.title,null,n.text.slice(0,150),a.ROOT_URL+n.path)});break;case"CATEGORIES":case"TAGS":i=n.map(function(n){return c("CATEGORIES"===t?"folder":"tag",n.name,n.slug,null,n.permalink)});break;default:return null}return r=e,s("<section>").addClass("ins-section").append(s("<header>").addClass("ins-section-header").text(r)).append(i)}function l(n,t){var e={};n.pages.concat(n.posts).forEach(function(n){n[t]&&n[t].forEach(function(n){e[n.name]=n})});var i=[];for(var t in e)i.push(e[t]);return i}function u(n){return n.split(" ").filter(function(n){return!!n}).map(function(n){return n.toUpperCase()})}function f(n,e,i){var t=u(n);return t.filter(function(t){return 0<i.filter(function(n){return!!e.hasOwnProperty(n)&&(-1<e[n].toUpperCase().indexOf(t)||void 0)}).length}).length===t.length}function p(n,r,t,s){var a=0;return u(n).forEach(function(n){var i=new RegExp(n,"img");t.forEach(function(n,t){if(r.hasOwnProperty(n)){var e=r[n].match(i);a+=e?e.length*s[t]:0}})}),a}function d(n,t){var e,i,r={POST:function(n){return p(i,n,["title","text"],[3,1])},PAGE:function(n){return p(i,n,["title","text"],[3,1])},CATEGORY:function(n){return p(i,n,["name","slug"],[1,1])},TAG:function(n){return p(i,n,["name","slug"],[1,1])}},s=(e=i=t,{POST:function(n){return f(e,n,["title","text"])},PAGE:function(n){return f(e,n,["title","text"])},CATEGORY:function(n){return f(e,n,["name","slug"])},TAG:function(n){return f(e,n,["name","slug"])}}),a=n.posts,o=n.pages,c=l(n,"tags"),u=l(n,"categories");return{posts:a.filter(s.POST).sort(function(n,t){return r.POST(t)-r.POST(n)}).slice(0,5),pages:o.filter(s.PAGE).sort(function(n,t){return r.PAGE(t)-r.PAGE(n)}).slice(0,5),categories:u.filter(s.CATEGORY).sort(function(n,t){return r.CATEGORY(t)-r.CATEGORY(n)}).slice(0,5),tags:c.filter(s.TAG).sort(function(n,t){return r.TAG(t)-r.TAG(n)}).slice(0,5)}}function t(n){var t=s.makeArray(o.find(".ins-selectable")),e=-1;t.forEach(function(n,t){s(n).hasClass("active")&&(e=t)});var i=(t.length+e+n)%t.length;s(t[e]).removeClass("active"),s(t[i]).addClass("active"),function(n){if(0!==n.length){var t=r[0].clientHeight,e=n.position().top-r.scrollTop(),i=n[0].clientHeight+n.position().top;i>t+r.scrollTop()&&r.scrollTop(i-r[0].clientHeight),e<0&&r.scrollTop(n.position().top)}}(s(t[i]))}function h(n){n&&n.length&&(location.href=n.attr("data-url"))}e.parent().remove(".ins-search"),s("body").append(e),s.getJSON(a.CONTENT_URL,function(t){"#ins-search"===location.hash.trim()&&e.addClass("show"),n.on("input",function(){var n=s(this).val();!function(n){for(var t in o.empty(),n)o.append(i(t.toUpperCase(),n[t]))}(d(t,n))}),n.trigger("input")}),s(document).on("click focus",".search-field",function(){e.addClass("show"),e.find(".ins-search-input").focus()}).on("click focus",".search-form-submit",function(){e.addClass("show"),e.find(".ins-search-input").focus()}).on("click",".ins-search-item",function(){h(s(this))}).on("click",".ins-close",function(){e.removeClass("show")}).on("keydown",function(n){if(e.hasClass("show"))switch(n.keyCode){case 27:e.removeClass("show");break;case 38:t(-1);break;case 40:t(1);break;case 13:h(o.find(".ins-selectable.active").eq(0))}})}(jQuery,window.INSIGHT_CONFIG);